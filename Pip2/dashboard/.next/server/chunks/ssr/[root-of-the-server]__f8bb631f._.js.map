{"version":3,"sources":["../../../../../../Pip2/dashboard/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../../../Pip2/dashboard/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../../../Pip2/dashboard/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../../../Pip2/dashboard/app/my-instances/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","'use client';\r\n\r\nimport { useSession } from 'next-auth/react';\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Pip2Instance {\r\n  id: string;\r\n  discord_user_id: string;\r\n  guild_id: string;\r\n  guild_name: string;\r\n  channel_id: string;\r\n  channel_name: string;\r\n  created_at: string;\r\n  is_active: boolean;\r\n}\r\n\r\nexport default function MyInstancesPage() {\r\n  const { data: session, status } = useSession();\r\n  const router = useRouter();\r\n  const [instances, setInstances] = useState<Pip2Instance[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (status === 'unauthenticated') {\r\n      router.push('/login?callbackUrl=/my-instances');\r\n    }\r\n  }, [status, router]);\r\n\r\n  useEffect(() => {\r\n    async function fetchInstances() {\r\n      if (!session?.user) return;\r\n\r\n      try {\r\n        const response = await fetch('/api/instances');\r\n        if (!response.ok) throw new Error('Failed to fetch instances');\r\n        const data = await response.json();\r\n        setInstances(data.instances || []);\r\n      } catch (err) {\r\n        setError('Failed to load your instances');\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    if (session?.user) {\r\n      fetchInstances();\r\n    }\r\n  }, [session]);\r\n\r\n  async function toggleInstance(instanceId: string, currentState: boolean) {\r\n    try {\r\n      const response = await fetch(`/api/instances/${instanceId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ is_active: !currentState }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error('Failed to update instance');\r\n\r\n      setInstances(instances.map(inst =>\r\n        inst.id === instanceId ? { ...inst, is_active: !currentState } : inst\r\n      ));\r\n    } catch (err) {\r\n      console.error('Error toggling instance:', err);\r\n    }\r\n  }\r\n\r\n  async function deleteInstance(instanceId: string) {\r\n    if (!confirm('Are you sure you want to delete this instance?')) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/instances/${instanceId}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!response.ok) throw new Error('Failed to delete instance');\r\n\r\n      setInstances(instances.filter(inst => inst.id !== instanceId));\r\n    } catch (err) {\r\n      console.error('Error deleting instance:', err);\r\n    }\r\n  }\r\n\r\n  if (status === 'loading' || loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n        <div className=\"text-gray-500\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (status === 'unauthenticated') {\r\n    return null; // Will redirect\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto\">\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">My Pip 2 Instances</h1>\r\n        <p className=\"text-gray-600 dark:text-gray-400 mt-2\">\r\n          Manage your RollCloud connections across Discord servers\r\n        </p>\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-400 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-6\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {instances.length === 0 ? (\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 text-center\">\r\n          <div className=\"text-gray-400 text-5xl mb-4\">+</div>\r\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n            No instances yet\r\n          </h2>\r\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n            Use the /rollcloud command in Discord to connect a server to RollCloud.\r\n          </p>\r\n          <a\r\n            href=\"/setup\"\r\n            className=\"inline-block bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium transition\"\r\n          >\r\n            View Setup Guide\r\n          </a>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {instances.map((instance) => (\r\n            <div\r\n              key={instance.id}\r\n              className={`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 ${\r\n                instance.is_active ? 'border-green-500' : 'border-gray-400'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n                    {instance.guild_name}\r\n                  </h3>\r\n                  <p className=\"text-gray-600 dark:text-gray-400\">\r\n                    #{instance.channel_name}\r\n                  </p>\r\n                  <p className=\"text-sm text-gray-500 dark:text-gray-500 mt-1\">\r\n                    Created {new Date(instance.created_at).toLocaleDateString()}\r\n                  </p>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <button\r\n                    onClick={() => toggleInstance(instance.id, instance.is_active)}\r\n                    className={`px-4 py-2 rounded-lg font-medium transition ${\r\n                      instance.is_active\r\n                        ? 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-400'\r\n                        : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400'\r\n                    }`}\r\n                  >\r\n                    {instance.is_active ? 'Pause' : 'Activate'}\r\n                  </button>\r\n                  <button\r\n                    onClick={() => deleteInstance(instance.id)}\r\n                    className=\"px-4 py-2 rounded-lg font-medium bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 transition\"\r\n                  >\r\n                    Delete\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-4 flex items-center gap-2\">\r\n                <span\r\n                  className={`inline-block w-2 h-2 rounded-full ${\r\n                    instance.is_active ? 'bg-green-500' : 'bg-gray-400'\r\n                  }`}\r\n                />\r\n                <span className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                  {instance.is_active ? 'Active' : 'Paused'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"mt-8 bg-gray-100 dark:bg-gray-800/50 rounded-xl p-6\">\r\n        <h3 className=\"font-semibold text-gray-900 dark:text-white mb-2\">Need help?</h3>\r\n        <p className=\"text-gray-600 dark:text-gray-400 text-sm\">\r\n          To add a new instance, invite Pip 2 to your Discord server and use the{' '}\r\n          <code className=\"bg-gray-200 dark:bg-gray-700 px-1 rounded\">/rollcloud</code>{' '}\r\n          command to connect it to RollCloud.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml"],"mappings":"gjBAAAA,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,CACRC,QAAQ,CAAC,QAAW,CAACC,gBAAgB,+BCFvCJ,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,CACRC,QAAQ,CAAC,QAAW,CAACE,kBAAkB,+BCFzCL,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,CACRC,QAAQ,CAAC,QAAW,CAACG,kBAAkB,0CCAzC,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OAae,SAAS,IACtB,GAAM,CAAE,KAAM,CAAO,QAAE,CAAM,CAAE,CAAG,CAAA,EAAA,EAAA,UAAA,AAAU,IACtC,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,EAAE,EACvD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MA8BlD,eAAe,EAAe,CAAkB,CAAE,CAAqB,EACrE,GAAI,CAOF,GAAI,CAAC,CANY,MAAM,MAAM,CAAC,eAAe,EAAE,EAAA,CAAY,CAAE,CAC3D,OAAQ,QACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,UAAW,CAAC,CAAa,EAClD,EAAA,EAEc,EAAE,CAAE,MAAM,AAAI,MAAM,6BAElC,EAAa,EAAU,GAAG,CAAC,GACzB,EAAK,EAAE,GAAK,EAAa,CAAE,GAAG,CAAI,CAAE,UAAW,CAAC,CAAa,EAAI,GAErE,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,2BAA4B,EAC5C,CACF,CAEA,eAAe,EAAe,CAAkB,EAC9C,GAAK,CAAD,OAAS,kDAEb,CAFgE,EAE5D,CAKF,GAAI,CAAC,CAJY,MAAM,MAAM,CAAC,eAAe,EAAE,EAAA,CAAY,CAAE,CAC3D,OAAQ,QACV,EAAA,EAEc,EAAE,CAAE,MAAM,AAAI,MAAM,6BAElC,EAAa,EAAU,MAAM,CAAC,GAAQ,EAAK,EAAE,GAAK,GACpD,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,2BAA4B,EAC5C,CACF,OAEA,CA9DA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,AAAW,mBAAmB,IAChC,EAAO,IAAI,CAAC,mCAEhB,EAAG,CAAC,EAAQ,EAAO,EAEnB,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KACR,eAAe,IACb,GAAK,CAAD,EAAU,KAEd,CAFoB,EAEhB,CACF,IAAM,EAAW,MAAM,MAAM,kBAC7B,GAAI,CAAC,EAAS,EAAE,CAAE,MAAM,AAAI,MAAM,6BAClC,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAa,EAAK,SAAS,EAAI,EAAE,CACnC,CAAE,MAAO,EAAK,CACZ,EAAS,iCACT,QAAQ,KAAK,CAAC,EAChB,QAAU,CACR,GAAW,EACb,CACF,CAEI,GAAS,MACX,AADiB,GAGrB,EAAG,CAAC,EAAQ,EAoCG,YAAX,GAAwB,GAExB,CAAA,EAAA,EAAA,CAFiC,EAEjC,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,iBAKtB,mBAAmB,CAA9B,EACK,KAIP,CAAA,AAJa,EAIb,EAAA,IAAA,EAAC,MAAA,AAJ4B,CAIxB,UAAU,8BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4DAAmD,uBACjE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDAAwC,gEAKtD,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qHACZ,IAIiB,IAArB,EAAU,MAAM,CACf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCAA8B,MAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEAA2D,qBAGzE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDAAwC,4EAGrD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAK,SACL,UAAU,+GACX,wBAKH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAU,GAAG,CAAC,AAAC,GACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,CAAC,8DAA8D,EACxE,EAAS,SAAS,CAAG,mBAAqB,kBAAA,CAC1C,WAEF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+DACX,EAAS,UAAU,GAEtB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6CAAmC,IAC5C,EAAS,YAAY,IAEzB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0DAAgD,WAClD,IAAI,KAAK,EAAS,UAAU,EAAE,kBAAkB,SAG7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAe,EAAS,EAAE,CAAE,EAAS,SAAS,EAC7D,UAAW,CAAC,4CAA4C,EACtD,EAAS,SAAS,CACd,+FACA,0FAAA,CACJ,UAED,EAAS,SAAS,CAAG,QAAU,aAElC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAe,EAAS,EAAE,EACzC,UAAU,qIACX,iBAKL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,UAAW,CAAC,kCAAkC,EAC5C,EAAS,SAAS,CAAG,eAAiB,cAAA,CACtC,GAEJ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDACb,EAAS,SAAS,CAAG,SAAW,gBA3ChC,EAAS,EAAE,KAmDxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4DAAmD,eACjE,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,qDAA2C,yEACiB,IACvE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qDAA4C,eAAkB,IAAI,8CAM5F","ignoreList":[0,1,2]}